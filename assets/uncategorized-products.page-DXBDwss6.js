import{j as e,B as i,S as B,A as w,a1 as D,ac as j,I as E,aV as T,Q as R,a2 as W,W as M,h as x,ad as O,D as V,C as $,G as L}from"./mui-vendor-D4OjBZQt.js";import{a as c,b as k}from"./react-vendor-DYr15v6v.js";import{u as z,w as q,a as C,I as G,l as K,n as _,K as H,L as Q,M as Y}from"./index-BIOtAz8Z.js";import{P as J,a as X}from"./ProductTableToolbar-CAnoAnGG.js";import{D as Z}from"./DataTable-EonKnU6y.js";import{F as ee}from"./FormattedCurrency-Cr38E1t8.js";import{V as te,a as ae}from"./ActionButtons-BZGx5Hc7.js";import"./redux-vendor-CLOwJCHO.js";import"./firebase-vendor-OxXAdhiL.js";import"./utils-vendor-CFocuF-S.js";import"./pdf-vendor-CApBJrGQ.js";const re=({products:s,onEdit:g,onFilterChange:p,onBulkCategoryUpdate:d})=>{const u=z(),[l,n]=c.useState([]),[h,f]=c.useState({}),[b,r]=c.useState(!1),[m,P]=c.useState("");c.useEffect(()=>{u(q())},[u]);const y=C(G),A=t=>{f(t),p(t)},F=t=>{n(a=>a.includes(t)?a.filter(o=>o!==t):[...a,t])},I=async(t,a)=>{if(d)try{await d(t,a),n([]);const o=N(a);P(`Successfully assigned ${t.length} product(s) to category "${o}"`),r(!0)}catch{P("Failed to assign category to products"),r(!0)}},S=()=>{r(!1)},N=t=>{if(!t||!Array.isArray(y))return"-";const a=y.find(o=>o.id===t);return a?a.name:"-"},U=[{id:"select",label:"",format:(t,a)=>a?e.jsx(D,{checked:l.includes(a.sku),onChange:()=>F(a.sku)}):null},{id:"sku",label:"SKU",filter:!0},{id:"name",label:"Name",filter:!0},{id:"categoryId",label:"Category",format:()=>e.jsx(j,{label:"No Category",color:"warning",size:"small"})},{id:"platform",label:"Platform",format:t=>{const a=t;return e.jsx(j,{label:a.toUpperCase(),color:t==="amazon"?"default":"primary"})},filter:!0},{id:"sellingPrice",label:"Selling Price",align:"right",format:t=>e.jsx(ee,{value:t})},{id:"actions",label:"Actions",align:"center",format:(t,a)=>v(a)}],v=t=>{var a,o;return e.jsxs(e.Fragment,{children:[e.jsx(E,{size:"small","aria-label":`edit-${t.sku}`,onClick:()=>g(t),children:e.jsx(T,{})}),((a=t.metadata)==null?void 0:a.flipkartSerialNumber)&&e.jsx(te,{flipkartSerialNumber:t.metadata.flipkartSerialNumber}),((o=t.metadata)==null?void 0:o.amazonSerialNumber)&&e.jsx(ae,{amazonSerialNumber:t.metadata.amazonSerialNumber})]})};return e.jsxs(i,{sx:{width:"100%"},children:[e.jsx(J,{platform:h.platform,search:h.search,selectedProducts:l,categories:y,allProducts:s,onFilterChange:A,onBulkCategoryUpdate:I}),e.jsx(Z,{columns:U,data:s,defaultSortColumn:"sku",defaultSortDirection:"asc",rowsPerPageOptions:[10,25,50],defaultRowsPerPage:10}),e.jsx(B,{open:b,autoHideDuration:6e3,onClose:S,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(w,{onClose:S,severity:"success",sx:{width:"100%"},children:m})})]})},xe=()=>{const s=z(),{items:g,loading:p}=C(r=>r.products),d=C(K),[u,l]=k.useState(null),n=k.useMemo(()=>g.filter(r=>!r.categoryId||r.categoryId.trim()===""),[g]);c.useEffect(()=>{d&&s(_({}))},[s,d]);const h=async(r,m)=>{try{await s(Y({sku:r,data:m})).unwrap(),l(null)}catch{}},f=async(r,m)=>{try{await s(H({skus:r,data:{categoryId:m}})).unwrap()}catch{}},b=r=>{s(Q(r))};return e.jsx(R,{maxWidth:"xl",sx:{py:3},children:e.jsxs(W,{sx:{p:3,mb:4,borderRadius:2},children:[e.jsx(i,{sx:{display:"flex",alignItems:"center",mb:3,justifyContent:"space-between"},children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(M,{sx:{fontSize:32,mr:2,color:"warning.main"}}),e.jsx(x,{variant:"h4",component:"h1",sx:{fontWeight:"bold",color:"warning.dark"},children:"Uncategorized Products"}),e.jsx(j,{label:`${n.length} Products`,color:"warning",size:"medium",sx:{ml:2}})]})}),"        ",n.length>0&&e.jsxs(w,{severity:"warning",sx:{mb:3},children:[e.jsx(O,{children:"Action Required"}),"You have ",n.length," product(s) without categories. Products without categories may not appear in reports and analytics correctly. Please assign categories to these products for better organization and tracking."]}),e.jsx(V,{sx:{mb:3}}),e.jsx(i,{sx:{width:"100%"},children:p?e.jsx(i,{display:"flex",justifyContent:"center",alignItems:"center",m:4,children:e.jsx($,{color:"warning",size:40,thickness:4})}):n.length===0?e.jsxs(i,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:8,children:[e.jsx(L,{sx:{fontSize:64,color:"success.main",mb:2}}),e.jsx(x,{variant:"h5",sx:{fontWeight:"bold",color:"success.dark",mb:1},children:"All Products Categorized!"}),e.jsx(x,{variant:"body1",color:"text.secondary",textAlign:"center",children:"Great job! All your products have been assigned to categories. This helps with better organization and reporting."})]}):e.jsxs(i,{children:[e.jsx(x,{variant:"h6",sx:{mb:2,fontWeight:"bold",color:"warning.dark"},children:"Products Requiring Category Assignment"}),e.jsx(re,{products:n,onEdit:l,onFilterChange:b,onBulkCategoryUpdate:f})]})}),u&&e.jsx(X,{product:u,onClose:()=>l(null),onSave:h})]})})};export{xe as UncategorizedProductsPage,xe as default};
